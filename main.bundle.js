(()=>{"use strict";var e,t={62040:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const s=i(60484),a=i(29266);t.Manager=class{constructor(e){this.ui=e,this.generalQueue=[],this.speed=.5,this.gateIsFree=!0,this.forReservation=[]}init(){setInterval((()=>{this.spawnShip()}),8e3)}spawnShip(){const e=this.ui.createShip();this.sendShip(e)}async sendShip(e,t="start"){switch(t){case"start":await this.startAnimation(e),await this.sendShip(e,"toGates");break;case"toGates":const t=this.getAvailabilityPier(e.cargoType);if(!this.gateIsFree||"port"!==e.location&&!t)return void this.addToGeneralQueue(e);if(this.setGatesIsFree(!1),"sea"===e.location){if(!t)return;t.reserved=!0,e.currentPierIndex=t.index,await this.gatesAnimation(e),e.location="port",await this.sendShip(e,"load")}else null!==e.currentPierIndex&&(this.ui.piers[e.currentPierIndex].reserved=!1,e.currentPierIndex=null),await this.gatesAnimation(e),e.location="sea",await this.sendShip(e,"return");break;case"load":await this.loadAnimation(e),await this.sendShip(e,"toGates");break;case"return":await this.returnAnimation(e)}}startAnimation(e){return new Promise(((t,i)=>{const a=e.cargoType,r=e.width+20,{x:n,y:h}=this.ui.getQueuePointByCargoType(e.cargoType),o=Math.abs(e.x-n)/this.speed,d=new s.Tween(e).to({x:n,y:h},o).onComplete((()=>t())).onUpdate((e=>{if(e.x,this.generalQueue.length>0){const i=this.generalQueue.filter((e=>e.cargoType===a)),s=n+r*i.length;s>=e.x&&(d.stop(),e.x=s,t())}})).start()}))}gatesAnimation(e){return new Promise(((t,i)=>{let a,r,n,h,o,d,u;"sea"===e.location?(a=this.ui.gates.x+this.ui.gates.width+e.width/2,r=this.ui.gates.y+this.ui.gates.height/2,n=Math.abs(e.y-r)/this.speed,h="withCargo"===e.cargoType?Math.PI/2:-Math.PI/2,o=this.ui.gates.x-e.width/2,d=this.ui.gates.y+this.ui.gates.height/2,u=Math.abs(e.x-o)/this.speed):(a=this.ui.gates.x-e.width/2,r=this.ui.gates.y+this.ui.gates.height/2,n=Math.sqrt(Math.abs(a-e.x)*Math.abs(a-e.x)+Math.abs(r-e.y)*Math.abs(r-e.y))/this.speed,h=0,o=this.ui.gates.x+this.ui.gates.width+e.width/2,d=this.ui.gates.y+this.ui.gates.height/2,u=Math.abs(o-a)/this.speed);const c=new s.Tween(e).to({x:a,y:r,rotation:h},n),l=new s.Tween(e).to({x:o,y:d,rotation:0},u).onComplete((async()=>{this.setGatesIsFree(!0),t()}));c.chain(l),c.start()}))}loadAnimation(e){return new Promise(((t,i)=>{let r=e.currentPierIndex;if(null===r)return void t();let n=this.ui.piers[r].width+e.width/2,h=this.ui.piers[r].y+this.ui.piers[r].height/2,o=Math.sqrt(Math.abs(e.x-n)*Math.abs(e.x-n)+Math.abs(e.y-h)*Math.abs(e.y-h))/this.speed;new s.Tween(e).to({x:n,y:h},o).onComplete((async()=>(await(0,a.wait)(3e3),e.changeLoadState(!e.loaded),this.ui.piers[r].changeLoadState(!this.ui.piers[r].loaded),t()))).start()}))}returnAnimation(e){return new Promise(((t,i)=>{let a=this.ui.getCanvasSize().width+e.width/2,r=this.ui.getCanvasSize().height/2,n=(this.ui.getCanvasSize().width-e.x+e.width/2)/this.speed;new s.Tween(e).to({x:a,y:r},n).onComplete((()=>t())).start()}))}moveQueue(e){return new Promise(((t,i)=>{const a=e.width+20,r=e.x-a,n=e.y,h=a/this.speed;new s.Tween(e).to({x:r,y:n},h).onComplete((()=>t())).start()}))}getAvailabilityPier(e){const t=this.ui.piers.length;for(let i=0;i<t;i++)if("forCargo"===e&&this.ui.piers[i].loaded&&!this.ui.piers[i].reserved||"withCargo"===e&&!this.ui.piers[i].loaded&&!this.ui.piers[i].reserved)return this.ui.piers[i];return null}addToGeneralQueue(e){"sea"===e.location?this.generalQueue.push(e):this.generalQueue.unshift(e)}setGatesIsFree(e){this.gateIsFree=e,e&&this.updateQueue()}updateQueue(){let e=this.generalQueue.findIndex((e=>this.gateIsFree&&("port"===e.location||this.getAvailabilityPier(e.cargoType))));if(-1!==e){const t=this.generalQueue[e];this.generalQueue.splice(e,1),"sea"===t.location&&this.updateQueueCoordinates(t.cargoType),this.sendShip(t,"toGates")}}updateQueueCoordinates(e){const t=this.generalQueue.filter((t=>t.cargoType===e));t.length>0&&t.forEach((e=>{this.moveQueue(e)}))}}},50803:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,a)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&s(t,e,i);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;const n=i(95894),h=i(74457),o=r(i(60484));t.Scene=class{constructor(){this.app=new n.Application}async init(){await this.app.init({background:h.colors.background,width:1920,height:1080}),document.body.appendChild(this.app.canvas),window.addEventListener("resize",this.resize),this.resize(),this.runUpdates()}runUpdates(){this.app.ticker.add((()=>{o.update()}))}resize(){const e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=Math.min(e/1920,t/1080),s=Math.floor(1920*i),a=Math.floor(1080*i),r=(e-s)/2,n=(t-a)/2;this.app.canvas.style.width=s+"px",this.app.canvas.style.height=a+"px",this.app.canvas.style.marginLeft=this.app.canvas.style.marginRight=r+"px",this.app.canvas.style.marginTop=this.app.canvas.style.marginBottom=n+"px"}}},42123:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Pier=void 0;const s=i(95894),a=i(74457);class r extends s.Graphics{constructor(e){super(),this._index=e,this.loaded=!1,this.occupationType="free",this.reserved=!1,this.drawShip()}drawShip(){const{width:e,height:t,borderSize:i}=a.pierSize;this.rect(i/2,i/2,e-i,t-i),this.loaded&&this.fill(a.colors.green),this.stroke({width:i,color:a.colors.green})}get index(){return this._index}changeLoadState(e){this.clear(),this.loaded=e,this.drawShip()}}t.Pier=r},83557:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Ship=void 0;const s=i(95894),a=i(74457),r={forCargo:a.colors.green,withCargo:a.colors.red};class n extends s.Graphics{constructor(e){super(),this.currentPierIndex=null,this.location="sea",this.cargoType=e,this.loaded="withCargo"===e,this.drawShip(),this.pivot.set(this.width/2,this.height/2)}drawShip(){const{width:e,height:t,borderSize:i}=a.shipSize;this.rect(i/2,i/2,e-i,t-i),this.loaded&&this.fill(r[this.cargoType]),this.stroke({width:i,color:r[this.cargoType]})}changeLoadState(e){this.clear(),this.loaded=e,this.drawShip()}}t.Ship=n},20315:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UI=void 0;const s=i(33347),a=i(95894),r=i(83557),n=i(42123),h=i(74457);class o extends a.Container{constructor(e){super(),this.scene=e,this.piers=[],this.queuePoint={forCargo:{x:0,y:0},withCargo:{x:0,y:0}}}init(){this.createPiers(),this.createGates(),this.createWalls(),this.calcShipQueuePoints(),this.scene.app.stage.addChild(this)}createPiers(){const e=(this.scene.app.canvas.height-4*h.pierSize.height)/5;for(let t=0;t<4;t++)this.piers[t]=new n.Pier(t),this.piers[t].x=0,this.piers[t].y=(h.pierSize.height+e)*t+e,this.addChild(this.piers[t])}createWalls(){const e=(this.scene.app.canvas.height-this.gates.height)/2,t=new a.Graphics;t.rect(this.gates.x+this.gates.width/2-10,0,20,e),t.fill(h.colors.green),this.addChild(t);const i=new a.Graphics;i.rect(this.gates.x+this.gates.width/2-10,this.gates.y+this.gates.height,20,e),i.fill(h.colors.green),this.addChild(i)}createGates(){this.gates=new a.Sprite(a.Texture.EMPTY),this.gates.width=h.gatesSize.width,this.gates.height=h.gatesSize.height,this.gates.position.set(400-h.gatesSize.width/2,this.scene.app.canvas.height/2-h.gatesSize.height/2),this.addChild(this.gates)}createShip(){const e=(0,s.getRandomBoolean)()?"forCargo":"withCargo",t=new r.Ship(e),{y:i}=this.getQueuePointByCargoType(e);return t.position.set(this.getCanvasSize().width,i),this.addChild(t),t}getQueuePointByCargoType(e){return this.queuePoint[e]}getCanvasSize(){const{width:e,height:t}=this.scene.app.canvas;return{width:e,height:t}}calcShipQueuePoints(){const{x:e,y:t,width:i,height:s}=this.gates;this.queuePoint.forCargo.x=e+i+h.shipSize.width/2,this.queuePoint.forCargo.y=t-h.shipSize.height/2,this.queuePoint.withCargo.x=e+i+h.shipSize.width/2,this.queuePoint.withCargo.y=t+s+h.shipSize.height/2}}t.UI=o},61859:(e,t,i)=>{const s=i(62040),a=i(50803),r=i(20315);(async()=>{const e=new a.Scene;await e.init();const t=new r.UI(e);t.init(),new s.Manager(t).init()})()},21153:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colors=void 0,t.colors={green:16766976,red:16711680,background:5060095}},74457:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,a)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),a(i(21153),t),a(i(34251),t)},34251:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gatesSize=t.pierSize=t.shipSize=void 0,t.shipSize={width:120,height:60,borderSize:10},t.pierSize={width:60,height:150,borderSize:10},t.gatesSize={width:50,height:200}},29266:function(e,t,i){var s=this&&this.__createBinding||(Object.create?function(e,t,i,s){void 0===s&&(s=i);var a=Object.getOwnPropertyDescriptor(t,i);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,a)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]}),a=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||s(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),a(i(33347),t),a(i(56305),t)},33347:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomBoolean=void 0,t.getRandomBoolean=()=>Math.random()<.5},56305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wait=void 0,t.wait=e=>new Promise((t=>{setTimeout((()=>{t()}),e)}))}},i={};function s(e){var a=i[e];if(void 0!==a)return a.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,s),r.exports}s.m=t,e=[],s.O=(t,i,a,r)=>{if(!i){var n=1/0;for(u=0;u<e.length;u++){for(var[i,a,r]=e[u],h=!0,o=0;o<i.length;o++)(!1&r||n>=r)&&Object.keys(s.O).every((e=>s.O[e](i[o])))?i.splice(o--,1):(h=!1,r<n&&(n=r));if(h){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,a,r]},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var a,r,[n,h,o]=i,d=0;if(n.some((t=>0!==e[t]))){for(a in h)s.o(h,a)&&(s.m[a]=h[a]);if(o)var u=o(s)}for(t&&t(i);d<n.length;d++)r=n[d],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(u)},i=self.webpackChunkgameboats=self.webpackChunkgameboats||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var a=s.O(void 0,[121],(()=>s(61859)));a=s.O(a)})();